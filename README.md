# WeKnoledge - 企业级智能知识管理平台

<div align="center">
  <img src="docs/images/logo.png" alt="WeKnoledge Logo" width="200"/>
  <p>强大的企业知识管理与智能问答平台</p>
</div>

[![License](https://img.shields.io/badge/license-Apache%202.0-blue.svg)](LICENSE)
[![PostgreSQL](https://img.shields.io/badge/Database-PostgreSQL-blue.svg)](https://www.postgresql.org/)
[![FastAPI](https://img.shields.io/badge/Backend-FastAPI-009688.svg)](https://fastapi.tiangolo.com/)
[![Next.js](https://img.shields.io/badge/Frontend-Next.js-black.svg)](https://nextjs.org/)

## 📖 项目介绍

WeKnoledge 是一个开源的企业级智能知识管理平台，结合了知识库管理、文档处理与智能问答功能，帮助企业高效管理和利用知识资产。平台支持多种文档格式的导入、向量化存储和检索，同时利用大型语言模型提供智能问答和知识挖掘功能。

## ✨ 核心功能

- **文档管理**：上传、组织和管理多种格式的文档
- **智能问答**：基于企业知识库的精准问答服务
- **文档检索**：高效向量检索，支持语义搜索
- **智能写作**：AI辅助内容创作和文本优化
- **多用户管理**：完善的权限系统和团队协作功能
- **可视化仪表盘**：直观展示知识库使用情况和热点分析

## 🔧 技术架构

- **前端**：Next.js + Ant Design + TailwindCSS
- **后端**：FastAPI + SQLAlchemy
- **数据库**：PostgreSQL + pgvector
- **AI模型**：支持接入OpenAI、Anthropic和本地模型

## 🚀 快速开始

### 环境要求

- Python 3.10+
- Node.js 18+
- PostgreSQL 14+ (with pgvector extension)
- Docker (推荐)

### 使用Docker Compose部署

1. 克隆仓库
```bash
git clone https://github.com/yourusername/weknowledge.git
cd weknowledge
```

2. 配置环境变量
```bash
cp .env.example .env
# 编辑.env文件配置数据库和OpenAI API密钥
```

3. 启动服务
```bash
docker-compose up -d
```

4. 访问平台
```
http://localhost:3000
```

默认管理员账户: 
- 用户名: admin
- 密码: admin123

### 手动部署

#### 后端部署

1. 切换到后端目录
```bash
cd backend
```

2. 创建Python虚拟环境
```bash
python -m venv venv
source venv/bin/activate  # 在Windows上使用 venv\Scripts\activate
```

3. 安装依赖
```bash
pip install -r requirements.txt
```

4. 配置环境变量
```bash
cp .env.example .env
# 编辑.env文件
```

5. 初始化数据库
```bash
alembic upgrade head
python -c "from app.db.init_db import init_db; from app.db.session import SessionLocal; db = SessionLocal(); init_db(db)"
```

6. 启动后端服务
```bash
uvicorn app.main:app --reload
```

#### 前端部署

1. 切换到前端目录
```bash
cd frontend
```

2. 安装依赖
```bash
npm install
```

3. 配置环境变量
```bash
cp .env.example .env.local
# 编辑.env.local文件
```

4. 启动开发服务器
```bash
npm run dev
```

5. 构建生产版本
```bash
npm run build
npm start
```

## 📚 文档

详细文档请参阅 [docs](docs/) 目录。

## 🤝 贡献指南

欢迎贡献代码、报告问题或提供改进建议。请查阅我们的 [贡献指南](CONTRIBUTING.md) 了解更多信息。

## 📄 许可证

本项目基于 Apache License 2.0 开源，并附有额外条件。详情请参阅 [LICENSE](LICENSE) 文件。

# 企业级智能知识库平台 - 前端

本项目是企业级智能知识管理平台的前端部分，旨在构建企业内部知识中心，提升知识资产价值，赋能员工高效工作。

## 技术栈

* React 19
* Next.js 15
* TypeScript
* Ant Design 5
* Tailwind CSS

## 主要功能

* 知识沉淀：支持各种形式的知识管理，包括文档、图片等
* 智能检索：强大的搜索能力，快速找到所需知识
* AI赋能：智能问答、写作辅助、文档解读
* 权限管理：精细的权限控制，保障企业知识安全
* 组织协作：支持团队协作，共享知识资产
* 数据分析：提供知识库使用情况分析

## 目录结构

```
/frontend
├── public/                      # 静态资源
│   └── images/                  # 图片资源
├── src/                         # 源代码
│   ├── components/              # React组件
│   │   ├── common/              # 通用组件
│   │   ├── layout/              # 布局相关组件
│   │   └── features/            # 按功能模块组织的组件
│   │       ├── search/          # 搜索相关组件
│   │       ├── knowledge/       # 知识库相关组件
│   │       ├── document/        # 文档解读相关组件
│   │       ├── writing/         # 智能写作相关组件
│   │       ├── history/         # 历史记录相关组件
│   │       └── admin/           # 管理后台相关组件
│   ├── pages/                   # Next.js页面
│   ├── services/                # API服务
│   ├── utils/                   # 工具函数
│   ├── styles/                  # 样式文件
│   └── types/                   # TypeScript类型定义
├── next.config.js               # Next.js配置
├── postcss.config.js            # PostCSS配置
├── tailwind.config.js           # Tailwind CSS配置
├── tsconfig.json                # TypeScript配置
└── package.json                 # 项目依赖和脚本
```

## 启动项目

```bash
# 安装依赖
npm install

# 开发环境启动
npm run dev

# 生产环境构建
npm run build

# 生产环境启动
npm run start
```

访问 [http://localhost:3000](http://localhost:3000) 查看应用。

## 用户角色

* 普通用户：企业内部员工，需要获取和利用知识完成工作任务
* 管理员用户：企业知识管理负责人、IT管理员等，负责知识库的维护、管理和配置

## 功能模块

1. 智能问答与知识检索
2. 智能写作
3. 文档解读
4. 个人知识库
5. 组织知识库访问
6. 历史提问消息
7. 组织架构维护（管理员）
8. 模型信息配置（管理员）
9. 仪表盘查看（管理员） 



好的，请看以下产品功能、功能逻辑和UI/UX布局的设计文档。这个文档将分为几个部分，详细描述您知识库产品的各个方面。

**文档标题：企业级智能知识库平台设计文档**

**1. 产品概述**

*   **产品名称:**  [请在此处填写您的产品名称，例如：智库云、知识引擎等]
*   **产品定位:**  企业级智能知识管理平台，旨在构建企业内部知识中心，提升知识资产价值，赋能员工高效工作。
*   **核心功能:**  知识沉淀、智能检索、AI赋能（智能问答、写作辅助、文档解读）、权限管理、组织协作、数据分析。
*   **目标用户:**
    *   **普通用户:**  企业内部员工，需要获取和利用知识完成工作任务。
    *   **管理员用户:**  企业知识管理负责人、IT管理员等，负责知识库的维护、管理和配置。

**2. 产品功能详细描述**

**2.1 普通用户功能**

*   **2.1.1 智能问答与知识检索**
    *   **功能描述:** 用户可以通过文本提问或上传文档/图片的方式，向知识库提问，系统利用AI模型进行智能匹配和解答，并支持关键词搜索快速查找知识。
    *   **功能逻辑:**
        1.  用户在搜索框输入问题或上传文档/图片。
        2.  系统接收用户输入，根据类型（文本、文档、图片）进行预处理。
        3.  **文本提问:**  系统进行语义理解，将问题向量化，与知识库中的知识条目进行相似度匹配，返回最相关的知识条目和答案。
        4.  **文档/图片提问:**  系统利用OCR和NLP技术解析文档/图片内容，提取文本信息，然后进行语义理解和知识匹配，返回相关答案和文档/图片内容片段。
        5.  **关键词搜索:** 用户输入关键词，系统在知识库全文索引中检索包含关键词的知识条目，按相关性排序返回结果。
        6.  系统将搜索结果以列表形式呈现，并支持点击查看知识条目详情。
    *   **UI/UX布局:**
        *   **首页搜索框:** 位于页面中心显著位置，支持文本输入框和上传按钮（文档/图片）。
        *   **搜索结果页:**  清晰展示搜索结果列表，每个结果条目包含标题、摘要、来源等信息，并高亮显示关键词。支持结果排序、筛选等功能。
        *   **知识条目详情页:**  完整展示知识条目内容，支持文本、图片、文档等多种形式，方便用户阅读和学习。

*   **2.1.2 智能写作**
    *   **功能描述:**  提供AI辅助写作功能，用户可以输入主题或关键词，系统根据知识库内容和预训练模型，生成文章段落、文案、报告等内容，提升写作效率。
    *   **功能逻辑:**
        1.  用户进入智能写作模块，选择写作类型（例如：文案、报告、邮件等）。
        2.  用户输入写作主题或关键词，并可选择写作风格、篇幅等参数。
        3.  系统根据用户输入，检索知识库中相关知识，并调用预训练的语言模型，生成初步的写作内容。
        4.  用户可以对生成的内容进行编辑、修改和润色，最终完成写作。
    *   **UI/UX布局:**
        *   **智能写作入口:**  位于主导航栏或快捷功能入口处。
        *   **写作界面:**  提供简洁的文本编辑器，方便用户输入主题、关键词和编辑生成内容。提供参数设置选项，例如写作风格、篇幅等。
        *   **生成结果展示区:**  清晰展示AI生成的写作内容，用户可以方便地复制、编辑和导出。

*   **2.1.3 文档解读**
    *   **功能描述:**  用户上传文档后，系统自动解析文档内容，提取关键信息、生成摘要、进行问答互动，帮助用户快速理解文档内容。
    *   **功能逻辑:**
        1.  用户上传文档（支持多种格式，如.docx, .pdf, .pptx等）。
        2.  系统解析文档内容，利用OCR技术识别图片文字，提取文档文本信息。
        3.  系统利用NLP技术进行文档内容分析，包括：
            *   **关键信息提取:**  提取文档主题、核心观点、关键人物、时间地点等信息。
            *   **自动摘要:**  生成文档的精简摘要。
            *   **问答互动:**  用户可以针对文档内容提问，系统基于文档内容进行解答。
        4.  系统将解读结果以结构化形式展示，例如：关键信息列表、摘要文本、问答对话框等。
    *   **UI/UX布局:**
        *   **文档解读入口:**  位于主导航栏或快捷功能入口处。
        *   **文档上传区域:**  支持拖拽上传或选择文件上传。
        *   **解读结果展示区:**  清晰展示文档关键信息、摘要、问答对话框等内容。支持用户复制、下载解读结果。

*   **2.1.4 个人知识库**
    *   **功能描述:**  用户拥有个人知识存储空间，可以上传、整理、管理个人相关的知识文档、笔记、书签等。
    *   **功能逻辑:**
        1.  用户可以创建文件夹，对个人知识进行分类管理。
        2.  用户可以上传文档、图片、音频、视频等多种类型的文件。
        3.  用户可以创建文本笔记，记录个人知识和想法。
        4.  用户可以添加书签，收藏重要的网页链接或知识条目。
        5.  个人知识库内容支持搜索和标签管理。
    *   **UI/UX布局:**
        *   **个人知识库入口:**  位于侧边导航栏，清晰标识为"个人知识库"。
        *   **知识库管理界面:**  采用树形目录结构展示文件夹，方便用户浏览和管理知识。提供文件上传、新建文件夹、新建笔记、添加书签等操作按钮。
        *   **知识预览和编辑界面:**  支持在线预览文档、图片等文件，方便用户查看个人知识。提供笔记编辑功能。

*   **2.1.5 组织知识库访问 (权限控制)**
    *   **功能描述:**  用户可以访问所属组织的共享知识库，但访问权限受到严格控制，只能查看自己权限范围内的知识内容，保障企业知识安全。
    *   **功能逻辑:**
        1.  系统根据用户的组织架构和角色信息，确定用户所属的组织和权限范围。
        2.  用户在"组织知识库"模块可以看到自己有权限访问的知识库列表。
        3.  用户可以浏览和搜索组织知识库中的知识条目。
        4.  对于没有权限的知识内容，系统会提示用户无权访问。
        5.  知识库权限由管理员用户进行配置和管理。
    *   **UI/UX布局:**
        *   **组织知识库入口:**  位于侧边导航栏，清晰标识为"组织知识库"。
        *   **知识库列表页:**  展示用户有权限访问的组织知识库列表，并显示知识库名称、描述、创建者等信息。
        *   **知识库浏览和搜索界面:**  与个人知识库类似，但展示的是组织共享的知识内容。权限控制提示信息需清晰易懂。

*   **2.1.6 历史提问消息**
    *   **功能描述:**  用户可以查看自己的历史提问记录，方便回顾和跟踪问题，以及复用之前的提问和答案。
    *   **功能逻辑:**
        1.  系统记录用户的每一次提问和系统回复，包括提问内容、提问时间、回复内容、相关知识条目等信息。
        2.  用户可以在"历史提问"模块查看自己的提问记录列表，并支持按时间、关键词等条件进行筛选和搜索。
        3.  用户可以点击查看历史提问的详细信息，包括完整的提问和回复内容。
    *   **UI/UX布局:**
        *   **历史提问入口:**  位于侧边导航栏或用户中心入口处，清晰标识为"历史提问"或"消息记录"。
        *   **提问记录列表页:**  展示用户的历史提问记录，每条记录包含提问时间、提问摘要、状态等信息。支持按时间倒序排列。
        *   **提问详情页:**  展示完整的提问内容、系统回复、相关知识条目等信息，方便用户回顾和复用。

**2.2 管理员用户功能 (包含普通用户所有功能)**

*   **2.2.1 组织架构维护**
    *   **功能描述:**  管理员可以创建、编辑、删除组织架构，包括部门、子部门、员工信息等，为知识库的权限管理和知识共享提供组织基础。
    *   **功能逻辑:**
        1.  管理员进入组织架构管理模块。
        2.  系统以树形结构展示当前的组织架构。
        3.  管理员可以进行以下操作：
            *   **新增部门:**  添加新的部门节点，并设置部门名称、描述等信息。
            *   **编辑部门:**  修改部门名称、描述等信息。
            *   **删除部门:**  删除部门节点（需确认部门下无子部门和员工）。
            *   **添加员工:**  在部门下添加员工，并设置员工姓名、工号、职位、所属部门等信息。
            *   **编辑员工:**  修改员工信息。
            *   **删除员工:**  删除员工信息。
            *   **调整员工部门:**  将员工从一个部门调整到另一个部门。
        4.  组织架构信息存储在数据库中，并用于权限控制、知识共享等功能。
    *   **UI/UX布局:**
        *   **组织架构管理入口:**  位于管理员后台管理菜单中，清晰标识为"组织架构管理"。
        *   **组织架构展示界面:**  采用树形结构可视化展示组织架构，方便管理员浏览和操作。提供清晰的操作按钮，例如"新增部门"、"新增员工"、"编辑"、"删除"等。
        *   **编辑表单:**  弹出表单用于新增或编辑部门、员工信息，表单字段清晰，操作便捷。

*   **2.2.2 全权限知识库访问**
    *   **功能描述:**  管理员可以访问所有权限的知识库，包括个人知识库和所有共享知识库，方便进行知识管理和监控。
    *   **功能逻辑:**
        1.  管理员登录系统后，系统识别其管理员角色。
        2.  在"组织知识库"模块，管理员可以看到所有组织知识库的列表，包括普通用户无权访问的知识库。
        3.  管理员可以浏览和搜索所有组织知识库中的知识条目，不受权限限制。
        4.  管理员可以查看个人知识库列表，并浏览和搜索个人知识库中的内容。
    *   **UI/UX布局:**
        *   **组织知识库列表页:**  管理员看到的组织知识库列表包含所有知识库，与普通用户有所区分，可以通过图标或标签进行标识。
        *   **知识库浏览和搜索界面:**  与普通用户界面相同，但管理员拥有查看所有内容的权限。

*   **2.2.3 模型信息配置**
    *   **功能描述:**  管理员可以配置知识库使用的AI模型信息，例如选择不同的语言模型、调整模型参数等，以优化知识库的智能能力和问答效果。
    *   **功能逻辑:**
        1.  管理员进入模型配置管理模块。
        2.  系统展示当前使用的AI模型信息，包括模型类型、版本、参数配置等。
        3.  管理员可以进行以下操作：
            *   **选择模型:**  从预设的模型列表中选择不同的AI模型。
            *   **配置参数:**  调整模型的各项参数，例如：相似度阈值、生成文本长度、模型推理精度等（具体参数取决于使用的模型）。
            *   **模型测试:**  提供模型测试功能，管理员可以通过输入测试问题，评估模型效果，并根据测试结果调整模型配置。
        4.  模型配置信息存储在系统中，并应用于智能问答、智能写作、文档解读等AI功能。
    *   **UI/UX布局:**
        *   **模型配置管理入口:**  位于管理员后台管理菜单中，清晰标识为"模型配置管理"或"AI模型配置"。
        *   **模型配置界面:**  清晰展示当前模型信息和可配置参数。提供下拉选择框、滑块、文本框等控件用于参数配置。提供"测试模型"按钮。
        *   **模型测试界面:**  提供文本输入框用于输入测试问题，展示模型测试结果和评估指标。

*   **2.2.4 仪表板查看**
    *   **功能描述:**  管理员可以查看仪表板，了解知识库的使用情况统计、用户活跃度分析、知识热度排行等数据，帮助管理员了解知识库的运行状况，并进行优化调整。
    *   **功能逻辑:**
        1.  管理员进入仪表板模块。
        2.  系统从后台数据统计模块获取数据，并在仪表板上可视化展示。
        3.  仪表板通常包含以下数据指标：
            *   **用户活跃度:**  日活用户、月活用户、用户登录次数等。
            *   **知识库使用量:**  知识条目数量、文档上传数量、提问次数、智能写作使用次数、文档解读使用次数等。
            *   **知识热度排行:**  热门搜索关键词、热门知识条目、热门文档等。
            *   **知识库增长趋势:**  知识条目数量、用户数量等随时间变化的趋势图。
            *   **错误日志和系统监控:**  展示系统运行状态、错误日志、性能指标等（可选）。
        4.  仪表板数据可以按时间范围进行筛选查看，例如：今日、昨日、近7天、近30天、自定义时间范围等。
    *   **UI/UX布局:**
        *   **仪表板入口:**  位于管理员后台管理菜单中，清晰标识为"仪表板"或"数据统计"。
        *   **仪表板展示界面:**  采用图表、数字等可视化方式展示数据指标，布局清晰、信息丰富。提供时间范围筛选控件。
        *   **数据指标可配置:**  允许管理员自定义仪表板展示的数据指标和图表类型（可选）。

**3. 功能逻辑流程图 (示例)**

这里提供一个简单的用户提问的功能逻辑流程图示例，其他功能类似，可以根据实际情况绘制更详细的流程图。

```mermaid
graph LR
    A[用户发起提问 (文本/文档/图片)] --> B{系统接收提问};
    B --> C{判断提问类型};
    C -- 文本提问 --> D[文本预处理 & 语义理解];
    C -- 文档/图片提问 --> E[OCR/NLP解析 & 文本提取];
    D --> F[知识库知识匹配];
    E --> F;
    F --> G{找到相关知识?};
    G -- Yes --> H[生成答案 & 返回结果];
    G -- No --> I[返回无相关结果提示];
    H --> J[用户查看答案];
    I --> J;
    J --> K[结束];
```

**4. UI/UX 布局框架 (示例)**

以下是一个简化的UI/UX布局框架，您可以根据实际需求进行调整和细化。

*   **整体布局:**  采用经典的左侧导航栏 + 顶部工具栏 + 主内容区域的布局。

    ```
    +-----------------------------------------------------+
    |  顶部工具栏 (Logo, 用户信息, 快捷操作)             |
    +-----------------------------------------------------+
    | 左侧导航栏                                       |  主内容区域
    | -------------------------------------------------- |  ---------------------------------------
    | - 首页                                            |  -  首页内容 (搜索框, 快捷功能入口)
    | - 个人知识库                                       |  -  知识库列表/知识条目详情/编辑器/解读结果
    | - 组织知识库                                       |  -  智能写作界面/历史提问列表/仪表板/管理后台
    | - 智能写作                                         |  -  ... (根据不同功能模块填充内容)
    | - 文档解读                                         |
    | - 历史提问                                         |
    | - 管理后台 (管理员用户可见)                          |
    |     - 组织架构管理                                  |
    |     - 模型配置管理                                  |
    |     - 仪表板                                        |
    |     - ...                                         |
    +-----------------------------------------------------+
    |  底部状态栏 (版本信息, 帮助文档, 空间使用情况等)    |
    +-----------------------------------------------------+
    ```

*   **首页:**
    *   中心位置放置搜索框，突出知识检索核心功能。
    *   下方或侧边设置快捷功能入口，例如：智能写作、文档解读、个人知识库入口等。
    *   可以展示一些知识库推荐内容或最新动态（可选）。

*   **知识库页面:**
    *   左侧树形目录展示知识分类（文件夹结构）。
    *   右侧列表展示知识条目，支持搜索和筛选。
    *   点击知识条目进入详情页，展示完整内容。

*   **管理后台页面:**
    *   采用Tab页或侧边导航栏进行功能模块切换（组织架构管理、模型配置、仪表板等）。
    *   每个模块页面根据具体功能进行布局，力求操作便捷、信息展示清晰。
